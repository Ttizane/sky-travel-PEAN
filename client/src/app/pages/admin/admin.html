<div class="container mx-auto p-4 md:p-6 mt-4 bg-gradient-to-br from-blue-50 via-white to-sky-50 rounded-2xl border border-blue-100 shadow-2xl mb-4 min-h-screen pb-24">
	<!-- Header -->
	<div class="hero bg-gradient-to-r from-blue-50 via-blue-100 to-sky-100 text-blue-900 rounded-xl mb-8 shadow-2xl border border-blue-200">
		<div class="hero-content text-center py-10">
			<div class="max-w-2xl">
				<h1 class="text-4xl font-bold mb-2">Dashboard Amministratore</h1>
				<p class="text-lg opacity-80">Gestione centrale utenti</p>
			</div>
			</div>
		</div>

		<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
		<!-- Left Column - Viewers -->
		<div class="lg:col-span-2 space-y-6">

			<!-- Compagnie -->
			<div class="card bg-white border border-blue-100 shadow-2xl">
				<div class="card-body bg-gradient-to-br from-blue-50 via-white to-sky-50 rounded-2xl">
          <div class="flex justify-between items-center mb-4">
            <h2 class="card-title text-2xl text-blue-900 flex items-center gap-2">
              Compagnie
            </h2>
						<div class="flex items-center gap-2">
							  <button class="btn bg-blue-600 hover:bg-blue-700 text-white border-0 shadow-lg btn-sm" (click)="openNuovaCompagnia()">
                Nuova Compagnia
              </button>
            </div>
					</div>

					<div class="overflow-x-auto border border-blue-200 rounded-lg shadow-sm" style="max-height: 300px; overflow-y: auto;">
						<table class="table table-zebra">
							<thead class="sticky top-0 bg-blue-50 z-10">
                <tr class="text-blue-900">
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Email</th>
                    <th>Paese</th>
                    <th>Azioni</th>
                </tr>
							</thead>
							<tbody>
								@if (compagnie && compagnie.length > 0) {
                  @for (c of compagnie; track c.utente) {
                    <tr class="hover:bg-blue-50/50 transition-colors">
                      <td>
                        <div class="font-bold">{{ c.utente }}</div>
                      </td>
											<td>
                        <div class="font-bold">{{ c.nome }}</div>
											</td>
                      <td>
                        <div class="font-semibold">{{ c.email }}</div>
                      </td>
                      <td>
                        <div class="font-semibold">{{ c.nazione }}</div>
                      </td>
                      <td>
                      <button class="btn btn-error btn-xs text-white transition-transform hover:scale-105"
                              (click)="removeCompagnia(c)">
                        Elimina
                      </button>
                      </td>
										</tr>
									}
                  } @else {
									<tr>
                    <td colspan="5" class="text-center py-8">
											<div class="text-blue-700">
												Nessuna compagnia presente
											</div>
										</td>
									</tr>
								}
                @if (isLoadingCompagnie) {
                  @for (r of [0,1,2]; track r) {
                    <tr>
                      <td><div class="skeleton h-4 w-10"></div></td>
                      <td><div class="skeleton h-4 w-40"></div></td>
                      <td><div class="skeleton h-4 w-56"></div></td>
                      <td><div class="skeleton h-4 w-24"></div></td>
                      <td><div class="skeleton h-6 w-20"></div></td>
                    </tr>
                  }
                }
							</tbody>
						</table>
					</div>
				</div>
        <!-- Modal Nuova Compagnia -->
        @if (isNuovaCompagniaOpen) {
          <app-nuova-compagnia [autoOpen]="true" (created)="onCompagniaCreata()" (closed)="isNuovaCompagniaOpen=false"></app-nuova-compagnia>
        }
			</div>

			<!-- Utenti -->
			<div class="card bg-white border border-blue-100 shadow-2xl">
				<div class="card-body bg-gradient-to-br from-blue-50 via-white to-sky-50 rounded-2xl">
								<div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-4">
									<h2 class="card-title text-2xl text-blue-900 flex items-center gap-2">
										Utenti
									</h2>
									<div class="join w-full md:w-auto">
							<input
								class="input input-bordered join-item border-blue-200 focus:border-blue-500 bg-white w-full md:w-80"
								placeholder="Cerca per ID o Email"
								[value]="searchQuery"
								(input)="onSearchChange($event)"
							/>
              <button class="btn join-item bg-blue-600 hover:bg-blue-700 text-white border-0" (click)="clearSearch()">Reset</button>
						</div>
					</div>

					<div class="overflow-x-auto border border-blue-200 rounded-lg shadow-sm" style="max-height: 300px; overflow-y: auto;">
						<table class="table table-zebra">
              <thead class="sticky top-0 bg-blue-50 z-10">
                <tr class="text-blue-900">
                  <th></th>
                  <th>ID</th>
                  <th>Email</th>
                  <th>Nome</th>
                  <th>Cognome</th>
                  <th>Azioni</th>
                </tr>
              </thead>
							<tbody>
                @if (passeggeriFiltrati && passeggeriFiltrati.length > 0) {
									@for (u of passeggeriFiltrati; track u.utente) {
										<tr class="hover:bg-blue-50/50 transition-colors">
                      <td>
                        <div class="flex items-center gap-3">
                          <div class="avatar">
                            <div class="w-8 h-8 rounded-full overflow-hidden border border-blue-200 bg-blue-50 flex items-center justify-center">
                              @if (u.foto) {
                                <img [src]="getPasseggeroPhoto(u)" class="w-full h-full object-cover" />
                              }
                            </div>
                          </div>
                        </div>
                        <div></div>
                      </td>
                      <td><div class="font-bold">{{ u.utente }}</div></td>
                      <td><div class="font-semibold">{{ u.email }}</div></td>
                      <td><div class="text-sm">{{ u.nome }}</div></td>
                      <td><div class="text-sm">{{ u.cognome }}</div></td>
                      <td>
						          <button class="btn btn-error btn-xs text-white transition-transform hover:scale-105"
                              (click)="removePasseggero(u)">
                        Elimina
                      </button>
                      </td>
                    </tr>
                  }
                } @else {
									<tr>
                    <td colspan="5" class="text-center py-8">
											<div class="text-blue-700">Nessun utente trovato</div>
										</td>
									</tr>
								}
                @if (isLoadingPasseggeri) {
                  @for (r of [0,1,2,3]; track r) {
                    <tr>
                      <td><div class="skeleton h-8 w-8 rounded-full"></div></td>
                      <td><div class="skeleton h-4 w-10"></div></td>
                      <td><div class="skeleton h-4 w-56"></div></td>
                      <td><div class="skeleton h-4 w-24"></div></td>
                      <td><div class="skeleton h-4 w-24"></div></td>
                      <td><div class="skeleton h-6 w-20"></div></td>
                    </tr>
                  }
                }
							</tbody>
						</table>
					</div>
				</div>
			</div>

      <!-- Attività recenti -->
      <div class="card bg-white border border-blue-100 shadow-2xl">
        <div class="card-body bg-gradient-to-br from-blue-50 via-white to-sky-50 rounded-2xl">
          <div class="flex items-center justify-between mb-2">
            <h2 class="card-title text-2xl text-blue-900 flex items-center gap-2">Attività recenti</h2>
          </div>
          <ul class="space-y-3">
            <li class="flex items-start gap-3 p-3 rounded-lg border border-blue-100 bg-white/60">
              <div class="rounded-full bg-blue-100 text-blue-700 p-2 border border-blue-200">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z" />
                </svg>
              </div>
              <div class="flex-1">
                <p class="text-sm text-blue-900"><span class="font-semibold">Nuova compagnia</span> registrata.</p>
                <p class="text-xs text-blue-600/80">2 ore fa</p>
              </div>
            </li>
            <li class="flex items-start gap-3 p-3 rounded-lg border border-blue-100 bg-white/60">
              <div class="rounded-full bg-blue-100 text-blue-700 p-2 border border-blue-200">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                </svg>
              </div>
              <div class="flex-1">
                <p class="text-sm text-blue-900">Utente ha aggiornato le <span class="font-semibold">informazioni profilo</span>.</p>
                <p class="text-xs text-blue-600/80">4 ore fa</p>
              </div>
            </li>
            <li class="flex items-start gap-3 p-3 rounded-lg border border-blue-100 bg-white/60">
              <div class="rounded-full bg-blue-100 text-blue-700 p-2 border border-blue-200">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                  <path stroke-linecap="round" stroke-linejoin="round" d="m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                </svg>
              </div>
              <div class="flex-1">
                <p class="text-sm text-blue-900">Rimosso un <span class="font-semibold">utente inattivo</span>.</p>
                <p class="text-xs text-blue-600/80">Ieri</p>
              </div>
            </li>
          </ul>
        </div>
      </div>
		</div>

		<!-- Right Column - Quick Stats -->
		<div class="space-y-6">
			<div class="card bg-white border border-blue-100 shadow-2xl">
				<div class="card-body bg-gradient-to-br from-blue-50 via-white to-sky-50 rounded-2xl">
					<h3 class="card-title mb-4 text-blue-900">Statistiche Rapide</h3>
					<div class="space-y-4">
						<div class="flex justify-between items-center">
							<span class="text-sm font-medium text-blue-800">Totale Compagnie</span>
							  <div class="text-sm font-medium text-blue-800">{{ compagnie.length || 0 }}</div>
						</div>
						<div class="flex justify-between items-center">
							<span class="text-sm font-medium text-blue-800">Totale Utenti</span>
							  <div class="text-sm font-medium text-blue-800">{{ passeggeri.length || 0 }}</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Azioni rapide -->
			<div class="card bg-white border border-blue-100 shadow-2xl">
				<div class="card-body bg-gradient-to-br from-blue-50 via-white to-sky-50 rounded-2xl">
					<h3 class="card-title mb-4 text-blue-900">Azioni rapide</h3>
					<div class="grid grid-cols-2 gap-3">
						<button class="btn btn-sm bg-blue-600 hover:bg-blue-700 text-white border-0 shadow" (click)="openNuovaCompagnia()">Nuova Compagnia</button>
						<button class="btn btn-sm border-blue-200" (click)="refreshCompagnie()">Ricarica Compagnie</button>
						<button class="btn btn-sm border-blue-200" (click)="refreshPasseggeri()">Ricarica Utenti</button>
					</div>
				</div>
			</div>

			<!-- Suggerimenti -->
			<div class="card bg-white border border-blue-100 shadow-2xl">
				<div class="card-body bg-gradient-to-br from-blue-50 via-white to-sky-50 rounded-2xl">
					<h3 class="card-title mb-4 text-blue-900">Suggerimenti</h3>
					<ul class="list-disc list-inside text-sm text-blue-900/90 space-y-2">
						<li>Usa la ricerca per filtrare rapidamente gli utenti per <span class="font-semibold">ID</span> o <span class="font-semibold">email</span>.</li>
						<li>Controlla le <span class="font-semibold">attività recenti</span> per monitorare cambiamenti importanti.</li>
						<li>Ricorda di effettuare un <span class="font-semibold">backup</span> periodico dei dati.</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
</div>

