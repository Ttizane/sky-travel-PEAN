@if (isOpen) {
<div class="modal modal-open">
	@if (isOpenPopup) {
		<div class="fixed inset-0 z-[120] flex items-center justify-center bg-black/20 backdrop-blur-sm">
			<div class="w-full max-w-xl mx-auto px-6">
				<app-popup
					[message]="popupMessage"
					[type]="popupType"
					(onClose)="closePopup()"
				></app-popup>
			</div>
		</div>
	}
	<div class="modal-box w-11/12 max-w-2xl modal-form-container bg-white border-2 border-blue-200 rounded-2xl shadow-2xl relative">
		<h3 class="text-2xl font-bold text-blue-900 mb-2">Registra nuova compagnia</h3>
		<p class="text-blue-600 mb-6">Inserisci le informazioni per creare l'account della compagnia</p>

		<form autocomplete="off" class="grid grid-cols-1 gap-4" (submit)="$event.preventDefault()">
			<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
				<div class="form-control">
					<label class="label"><span class="label-text text-blue-800 font-semibold">Email *</span></label>
					<input type="email" name="company_email" autocomplete="off" autocapitalize="none" spellcheck="false" inputmode="email" [value]="email" (input)="email = $any($event.target).value" placeholder="es. company@example.com" class="input w-full bg-white border-2 border-blue-200 focus:border-blue-400 hover:border-blue-300 rounded-xl focus:outline-none text-blue-800 placeholder-blue-400" required />
				</div>
				<div class="form-control">
					<label class="label"><span class="label-text text-blue-800 font-semibold">Password *</span></label>
					<input type="password" name="company_password" autocomplete="new-password" [value]="password" (input)="password = $any($event.target).value" placeholder="Minimo 6 caratteri" class="input w-full bg-white border-2 border-blue-200 focus:border-blue-400 hover:border-blue-300 rounded-xl focus:outline-none text-blue-800 placeholder-blue-400" minlength="6" required />
				</div>
			</div>

			<div class="form-control">
				<label class="label"><span class="label-text text-blue-800 font-semibold">Logo/Immagine *</span></label>
				<div class="flex flex-col md:flex-row md:items-end gap-3">
					<input type="file" accept="image/*" autocomplete="off" class="file-input flex-1 bg-white border-2 border-blue-200 focus:border-blue-400 hover:border-blue-300 rounded-xl focus:outline-none text-blue-800" (change)="onLogoSelected($event)" />
					<button type="button" class="btn bg-blue-600 hover:bg-blue-700 text-white border-0 shadow-lg" (click)="onCreateClick()" [disabled]="submitting">Aggiungi</button>
				</div>

				@if (logoPreview) {
					<div class="mt-3 flex items-center gap-3">
						<img [src]="logoPreview" alt="Anteprima logo" class="w-20 h-20 object-cover rounded-xl border border-blue-200" />
						<button type="button" class="btn btn-xs bg-blue-50 text-blue-700 border border-blue-200 hover:bg-blue-100" (click)="logoFile=null; logoPreview=null">Rimuovi</button>
					</div>
				}
			</div>
		</form>

		
	</div>
	<div class="modal-backdrop bg-black/40" (click)="close()"></div>
</div>
}
